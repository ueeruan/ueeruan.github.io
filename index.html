<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ru4nedits | Editor de V√≠deo Criativo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --dark-blue: #0A192F;
            --primary-blue: #38BDF8;
            --light-blue: #7DD3FC;
            --glass-bg: rgba(23, 37, 62, 0.3);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-color: #e2e8f0;
            --text-muted-color: #94a3b8;
        }

        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--dark-blue);
            color: var(--text-color);
            overflow-x: hidden;
            transition: background-color 0.5s, color 0.5s;
        }

        /* DYNAMIC LIQUID BACKGROUND & PARALLAX */
        .parallax-layer {
            position: fixed;
            width: 800px;
            height: 800px;
            border-radius: 50%;
            z-index: -1;
            pointer-events: none;
            transition: transform 0.2s ease-out;
            will-change: transform;
        }
        #liquid-cursor {
            background: radial-gradient(circle, rgba(56, 189, 248, 0.15), transparent 60%);
            filter: blur(120px);
        }
        #parallax-bg-1 {
            background: radial-gradient(circle, rgba(125, 211, 252, 0.05), transparent 70%);
            filter: blur(150px);
            top: -20%; left: -10%;
        }
        #parallax-bg-2 {
            background: radial-gradient(circle, rgba(56, 189, 248, 0.08), transparent 70%);
            filter: blur(100px);
            bottom: -30%; right: -15%;
        }

        /* GLASSMORPHISM CARD STYLE */
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border: 1px solid var(--glass-border);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .glass-card-hover:hover {
            border-color: rgba(56, 189, 248, 0.4);
            transform: translateY(-10px);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        /* PORTFOLIO CARD HOVER EFFECT */
        .portfolio-card { will-change: transform; }
        .portfolio-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            border-radius: inherit;
            background: radial-gradient(800px circle at var(--mouse-x) var(--mouse-y), rgba(255, 255, 255, 0.1), transparent 40%);
            opacity: 0;
            transition: opacity 0.5s;
        }
        .portfolio-card:hover::before { opacity: 1; }

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--dark-blue); }
        ::-webkit-scrollbar-thumb { background: rgba(56, 189, 248, 0.3); border-radius: 10px; }

        /* HERO VIDEO BACKGROUND */
        #hero-video-bg {
            position: absolute; top: 50%; left: 50%; width: 100%; height: 100%;
            object-fit: cover; transform: translate(-50%, -50%); z-index: -1;
            filter: blur(15px) brightness(0.3); opacity: 0.6;
        }

        /* ENTRANCE ANIMATIONS */
        .reveal { opacity: 0; transform: translateY(40px); transition: opacity 1s, transform 1s cubic-bezier(0.16, 1, 0.3, 1); }
        .reveal.visible { opacity: 1; transform: translateY(0); }
        
        /* CAROUSEL */
        .carousel-container { scroll-snap-type: x mandatory; scrollbar-width: none; -ms-overflow-style: none; }
        .carousel-item { scroll-snap-align: center; }

        /* MODAL ANIMATION */
        .modal-content { animation: modal-swoop 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes modal-swoop {
            from { opacity: 0; transform: translateY(50px) scale(0.9); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        /* WHATSAPP BUTTON LIQUID EFFECT */
        .whatsapp-button { position: relative; overflow: hidden; }
        .whatsapp-button span { position: absolute; border-radius: 50%; background: white; transform: scale(0); animation: ripple 0.6s linear; }
        @keyframes ripple { to { transform: scale(4); opacity: 0; } }

        /* GAMIFICATION BADGE */
        #badge-toast {
            transform: translateY(150%);
            transition: transform 0.5s cubic-bezier(0.215, 0.610, 0.355, 1);
        }
        #badge-toast.show {
            transform: translateY(0);
        }

        /* MINI JOGO */
        .draggable { touch-action: none; }
        #minigame-timeline { min-height: 80px; }
        .game-element { transition: background-color 0.3s; }
        .game-element.dragging { opacity: 0.5; }
        .timeline-item { animation: pop-in 0.3s ease; }
        @keyframes pop-in { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }

    </style>
</head>
<body class="min-h-screen">
    <div id="liquid-cursor" class="parallax-layer"></div>
    <div id="parallax-bg-1" class="parallax-layer"></div>
    <div id="parallax-bg-2" class="parallax-layer"></div>

    <!-- HEADER -->
    <header class="fixed top-0 left-0 right-0 z-50 p-4">
        <div class="container mx-auto max-w-7xl">
            <div class="glass-card flex justify-between items-center rounded-2xl px-6 py-3">
                <a href="#" class="flex items-center gap-3">
                    <div class="w-8 h-8 flex items-center justify-center">
                        <svg width="28" height="28" viewBox="0 0 24 24" class="text-sky-300">
                            <path d="M7 4v16l13-8z" fill="currentColor" style="transform: translateX(-1px); filter: drop-shadow(-1px 0 0 #38BDF8)"/>
                            <path d="M7 4v16l13-8z" fill="currentColor" style="transform: translateX(1px); filter: drop-shadow(1px 0 0 #0284C7)"/>
                            <path d="M7 4v16l13-8L7 4z" fill="rgba(224, 242, 254, 0.8)"/>
                        </svg>
                    </div>
                    <span class="text-xl font-bold text-white tracking-tight">ru4nedits</span>
                </a>
                <nav class="hidden md:flex items-center gap-6 text-sky-200">
                    <a href="#sobre" class="nav-link hover:text-white transition">Sobre</a>
                    <a href="#portfolio" class="nav-link hover:text-white transition">Portf√≥lio</a>
                    <a href="#minijogo" class="nav-link hover:text-white transition">Interativo</a>
                    <a href="#depoimentos" class="nav-link hover:text-white transition">Depoimentos</a>
                </nav>
            </div>
        </div>
    </header>

    <main>
        <!-- HERO SECTION -->
        <section class="relative min-h-screen flex items-center justify-center text-center p-4 overflow-hidden">
            <video id="hero-video-bg" playsinline autoplay muted loop src="https://cdn.pixabay.com/video/2022/10/24/135242-763458793_large.mp4"></video>
            <div class="relative z-10 glass-card rounded-3xl p-8 max-w-4xl reveal">
                <h1 class="text-5xl md:text-7xl font-extrabold tracking-tighter bg-clip-text text-transparent bg-gradient-to-br from-white to-sky-300">
                    Edi√ß√µes que transformam. Hist√≥rias que conectam.
                </h1>
                <p class="mt-6 max-w-2xl mx-auto text-lg text-sky-200">
                    Transformo v√≠deos brutos em narrativas impactantes que capturam a aten√ß√£o e geram resultados.
                </p>
                <a href="#portfolio" class="cta-button mt-8 inline-block bg-sky-500 text-white font-semibold py-3 px-8 rounded-full shadow-lg shadow-sky-500/30 transition-all transform hover:scale-105 hover:bg-sky-400">
                    Veja meu portf√≥lio
                </a>
            </div>
        </section>

        <!-- SOBRE SECTION -->
        <section id="sobre" class="container mx-auto max-w-5xl py-24 px-4 text-center">
            <div class="glass-card rounded-3xl p-12 reveal">
                <div class="flex flex-col md:flex-row items-center gap-12">
                    <div class="glass-card rounded-full p-2">
                        <div class="bg-blue-900/50 rounded-full w-32 h-32 flex items-center justify-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="text-sky-300"><polygon points="23 7 16 12 23 17 23 7"></polygon><rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect></svg>
                        </div>
                    </div>
                    <div class="text-left">
                        <h2 class="text-4xl font-bold text-white">Especialista em dar vida √†s suas ideias.</h2>
                        <p class="mt-4 text-sky-200">Com foco em storytelling e precis√£o t√©cnica, meu trabalho √© garantir que cada frame cumpra um prop√≥sito: engajar, emocionar e converter.</p>
                        <div class="mt-6 flex gap-8">
                            <div><span data-target="10" class="animated-stat text-3xl font-bold text-sky-400">0</span><span class="text-3xl font-bold text-sky-400">M+</span><p class="text-sm text-sky-200">Visualiza√ß√µes geradas</p></div>
                            <div><span data-target="100" class="animated-stat text-3xl font-bold text-sky-400">0</span><span class="text-3xl font-bold text-sky-400">+</span><p class="text-sm text-sky-200">Projetos entregues</p></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- PORTFOLIO SECTION -->
        <section id="portfolio" class="container mx-auto max-w-7xl py-24 px-4">
            <div class="text-center mb-12 reveal">
                <h2 class="text-5xl font-bold text-white">Portf√≥lio</h2>
                <p class="mt-4 text-lg text-sky-200">Uma amostra do meu trabalho em a√ß√£o.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Portfolio items will be injected by JS -->
            </div>
        </section>

        <!-- HIST√ìRIA ANIMADA SECTION -->
        <section id="historia" class="container mx-auto max-w-5xl py-24 px-4">
            <div class="text-center mb-12 reveal">
                <h2 class="text-5xl font-bold text-white">A jornada de um v√≠deo</h2>
                <p class="mt-4 text-lg text-sky-200">Veja como uma ideia se transforma em um resultado de impacto.</p>
            </div>
            <div class="glass-card rounded-3xl p-8 md:p-12 flex flex-col md:flex-row gap-8 items-center reveal">
                <div class="flex md:flex-col justify-around md:justify-start w-full md:w-1/4 gap-4">
                    <button data-step="1" class="story-step active p-4 rounded-lg text-left glass-card-hover">
                        <span class="font-bold text-white">1. O Problema</span><span class="text-sm block text-sky-300">V√≠deo sem impacto</span>
                    </button>
                    <button data-step="2" class="story-step p-4 rounded-lg text-left glass-card-hover">
                        <span class="font-bold text-white">2. A Edi√ß√£o</span><span class="text-sm block text-sky-300">M√°gica acontece</span>
                    </button>
                    <button data-step="3" class="story-step p-4 rounded-lg text-left glass-card-hover">
                        <span class="font-bold text-white">3. O Resultado</span><span class="text-sm block text-sky-300">Engajamento e convers√£o</span>
                    </button>
                </div>
                <div class="w-full md:w-3/4">
                    <div id="story-content" class="glass-card rounded-2xl p-6 min-h-[250px] transition-all duration-500">
                        <!-- Content will be injected by JS -->
                    </div>
                </div>
            </div>
        </section>

        <!-- MINI JOGO SECTION -->
        <section id="minijogo" class="container mx-auto max-w-5xl py-24 px-4">
            <div class="text-center mb-12 reveal">
                <h2 class="text-5xl font-bold text-white">Construa seu Mini V√≠deo</h2>
                <p class="mt-4 text-lg text-sky-200">Arraste os elementos para a timeline e veja a m√°gica acontecer.</p>
            </div>
            <div class="glass-card rounded-3xl p-8 md:p-12 reveal">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div id="minigame-elements" class="md:col-span-1 flex flex-col gap-4">
                        <div draggable="true" class="draggable game-element glass-card p-4 rounded-lg cursor-grab active:cursor-grabbing" data-type="text">‚úèÔ∏è Texto Impactante</div>
                        <div draggable="true" class="draggable game-element glass-card p-4 rounded-lg cursor-grab active:cursor-grabbing" data-type="effect">‚ú® Efeito Glitch</div>
                        <div draggable="true" class="draggable game-element glass-card p-4 rounded-lg cursor-grab active:cursor-grabbing" data-type="transition">üé¨ Transi√ß√£o R√°pida</div>
                        <div draggable="true" class="draggable game-element glass-card p-4 rounded-lg cursor-grab active:cursor-grabbing" data-type="sound">üîä Efeito Sonoro</div>
                    </div>
                    <div class="md:col-span-2">
                        <div id="minigame-player" class="glass-card rounded-xl aspect-video w-full flex items-center justify-center text-2xl text-sky-300/50 relative overflow-hidden">
                            <span>Player</span>
                        </div>
                        <div id="minigame-timeline" class="glass-card rounded-xl mt-4 p-4 flex items-center gap-2 flex-wrap border-dashed border-2 border-sky-500/30">
                            <span class="text-sky-400/50">Arraste aqui</span>
                        </div>
                         <div class="flex justify-end gap-4 mt-4">
                             <button id="clear-timeline-btn" class="glass-card-hover py-2 px-4 rounded-lg">Limpar</button>
                            <button id="play-timeline-btn" class="bg-sky-500 text-white font-semibold py-2 px-6 rounded-lg shadow-lg shadow-sky-500/30 transition-all transform hover:scale-105 hover:bg-sky-400">Play</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- DEPOIMENTOS SECTION -->
        <section id="depoimentos" class="py-24">
            <div class="text-center mb-12 reveal">
                <h2 class="text-5xl font-bold text-white">O que meus clientes dizem</h2>
                <p class="mt-4 text-lg text-sky-200">Resultados que falam por si.</p>
            </div>
            <div class="relative max-w-7xl mx-auto reveal">
                <div class="carousel-container flex overflow-x-auto snap-x snap-mandatory gap-8 px-4 pb-8">
                    <!-- Depoimentos ser√£o injetados aqui -->
                </div>
            </div>
        </section>
    </main>

    <!-- FLOATING BUTTONS & NOTIFICATIONS -->
    <a href="https://wa.me/5588996117377" target="_blank" class="whatsapp-button fixed bottom-6 right-6 z-50 bg-green-500 text-white w-16 h-16 rounded-full flex items-center justify-center shadow-lg transform transition-transform hover:scale-110">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="currentColor"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.886-.001 2.267.655 4.398 1.908 6.161l.114.162-1.217 4.459 4.569-1.195.163.097z"/></svg>
    </a>
    <div id="badge-toast" class="fixed bottom-6 left-6 z-50 glass-card rounded-xl p-4 flex items-center gap-4">
        <span id="badge-icon" class="text-2xl"></span>
        <div>
            <p id="badge-title" class="font-bold text-white"></p>
            <p id="badge-text" class="text-sm text-sky-200"></p>
        </div>
    </div>
    
    <!-- MODALS -->
    <div id="portfolio-modal" class="fixed inset-0 z-[60] bg-black/80 flex items-center justify-center p-4 hidden">
        <div class="modal-content glass-card rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto p-6 relative">
            <button class="modal-close-btn absolute top-4 right-4 text-white text-3xl hover:text-sky-300">&times;</button>
            <div class="aspect-video mb-4 rounded-lg overflow-hidden bg-black"><iframe id="modal-video" class="w-full h-full" src="" frameborder="0" allow="autoplay; fullscreen" allowfullscreen></iframe></div>
            <h3 id="modal-title" class="text-2xl font-bold text-white mb-2"></h3>
            <p id="modal-description" class="text-sky-200"></p>
            <div class="mt-4">
                <h4 class="font-semibold text-white">Antes e Depois (Simula√ß√£o)</h4>
                <div class="flex gap-4 mt-2">
                    <div class="w-1/2 bg-slate-800 rounded-md p-4 text-center text-slate-400">[Frame "Antes" - Sem cor e cortes]</div>
                    <div class="w-1/2 bg-blue-900/30 rounded-md p-4 text-center text-sky-200">[Frame "Depois" - Corrigido e estilizado]</div>
                </div>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- START AUDIO CONTEXT ON USER INTERACTION ---
    const startAudio = async () => {
        if (Tone.context.state !== 'running') {
            await Tone.start();
            console.log("Audio context started");
        }
        document.documentElement.removeEventListener('mousedown', startAudio);
        document.documentElement.removeEventListener('keydown', startAudio);
    };
    document.documentElement.addEventListener('mousedown', startAudio);
    document.documentElement.addEventListener('keydown', startAudio);

    // --- IMMERSIVE AUDIO SETUP ---
    const sounds = {
        pop: new Tone.PolySynth(Tone.Synth, {
            oscillator: { type: 'sine' },
            envelope: { attack: 0.005, decay: 0.1, sustain: 0.3, release: 0.4 },
            volume: -26 // Volume decreased
        }).toDestination(),
        glitch: new Tone.PolySynth(Tone.NoiseSynth, {
            noise: { type: 'pink' },
            envelope: { attack: 0.001, decay: 0.05, sustain: 0 },
            volume: -21 // Volume decreased
        }).toDestination(),
        swipe: new Tone.PolySynth(Tone.MembraneSynth, {
             pitchDecay: 0.008, octaves: 2, envelope: { attack: 0.0006, decay: 0.5, sustain: 0 }, volume: -16 // Volume decreased
        }).toDestination()
    };
    
    // --- DATA ---
    const portfolioData = [
        { id: 'kX1_rmdGhe4', title: 'Head de Tr√°fego', description: 'Edi√ß√£o din√¢mica com foco em convers√£o, utilizando motion graphics e cortes r√°pidos para prender a aten√ß√£o do espectador.' },
        { id: 'gMDAMt-tFo4', title: 'V√≠deo Curto Din√¢mico', description: 'Projeto focado em redes sociais, com legendas estilizadas e efeitos sonoros para maximizar o engajamento.' },
        { id: 'A9uGJAtHZ3U', title: 'Reel Vertical', description: 'Adapta√ß√£o de conte√∫do para o formato vertical, otimizando o enquadramento e adicionando elementos gr√°ficos.' },
        { id: 'fzYXEga_wnE', title: 'Alerta de Golpe', description: 'V√≠deo informativo com ritmo acelerado para criar um senso de urg√™ncia e clareza na mensagem.' },
        { id: '5bCEZgA11T0', title: 'Import√¢ncia do Advogado', description: 'Edi√ß√£o s√≥bria e profissional, focada em transmitir autoridade e confian√ßa atrav√©s de transi√ß√µes suaves.' },
        { id: 'Bh-6eIgu83U', title: 'Apresenta√ß√£o de App', description: 'V√≠deo de apresenta√ß√£o de produto, combinando captura de tela com anima√ß√µes para explicar funcionalidades.' },
    ];
    const testimonialsData = [
        { name: 'Cliente A', feedback: 'O trabalho do Ruan transformou completamente a forma como apresentamos nossos v√≠deos. A reten√ß√£o do p√∫blico aumentou em 40%!', company: 'Startup Inovadora' },
        { name: 'Cliente B', feedback: 'Profissionalismo e criatividade definem a edi√ß√£o. Entregou um resultado muito acima do esperado e dentro do prazo.', company: 'Ag√™ncia de Marketing' },
        { name: 'Cliente C', feedback: 'Incr√≠vel a capacidade de contar uma hist√≥ria. Nossos depoimentos agora emocionam e conectam de verdade com a audi√™ncia.', company: 'Produtora de Conte√∫do' },
    ];
    const storyData = {
        1: { title: 'An√°lise do Problema', content: 'Recebemos um v√≠deo bruto com grande potencial, mas sem ritmo, cor e clareza. O desafio √© transform√°-lo em uma pe√ßa que cative desde o primeiro segundo.' },
        2: { title: 'Processo de Edi√ß√£o Criativa', content: 'Aplicamos cortes din√¢micos, color grading profissional, motion graphics para destacar informa√ß√µes e uma trilha sonora que guia a emo√ß√£o. Cada detalhe √© ajustado.' },
        3: { title: 'Resultado de Impacto', content: 'O v√≠deo final n√£o apenas parece profissional, mas performa melhor. Aumento de engajamento, reten√ß√£o e, o mais importante, convers√£o para o cliente.' },
    };

    // --- DYNAMIC CONTENT INJECTION ---
    const portfolioGrid = document.querySelector('#portfolio .grid');
    portfolioData.forEach((item, index) => {
        const card = document.createElement('div');
        card.dataset.id = item.id;
        card.className = 'reveal portfolio-card relative glass-card rounded-2xl overflow-hidden glass-card-hover cursor-pointer';
        card.style.transitionDelay = `${index * 100}ms`;
        card.innerHTML = `<img src="https://i.ytimg.com/vi/${item.id}/hqdefault.jpg" alt="${item.title}" class="w-full h-48 object-cover transition-transform duration-300 group-hover:scale-105"><div class="p-4"><h3 class="font-bold text-white text-lg">${item.title}</h3><p class="text-sm text-sky-300 mt-1">Clique para ver detalhes</p></div>`;
        card.addEventListener('click', () => {
            if (Tone.context.state === 'running') sounds.glitch.triggerAttackRelease("8n");
            openModal('portfolio-modal', item);
        });
        portfolioGrid.appendChild(card);
    });
    const carouselContainer = document.querySelector('.carousel-container');
    testimonialsData.forEach(item => {
        const card = document.createElement('div');
        card.className = 'carousel-item flex-shrink-0 w-[80%] md:w-[45%]';
        card.innerHTML = `<div class="glass-card rounded-2xl p-8 h-full glass-card-hover"><p class="text-sky-200 italic">‚Äú${item.feedback}‚Äù</p><div class="mt-4 text-right"><p class="font-bold text-white">${item.name}</p><p class="text-sm text-sky-300">${item.company}</p></div></div>`;
        carouselContainer.appendChild(card);
    });

    // --- MODAL LOGIC ---
    const portfolioModal = document.getElementById('portfolio-modal');
    function openModal(modalId, data) {
        const modal = document.getElementById(modalId);
        if (modalId === 'portfolio-modal' && data) {
            modal.querySelector('#modal-video').src = `https://www.youtube.com/embed/${data.id}?autoplay=1`;
            modal.querySelector('#modal-title').textContent = data.title;
            modal.querySelector('#modal-description').textContent = data.description;
        }
        modal.classList.remove('hidden');
    }
    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        if (modalId === 'portfolio-modal') modal.querySelector('#modal-video').src = "";
        modal.classList.add('hidden');
    }
    document.querySelectorAll('.modal-close-btn').forEach(btn => btn.addEventListener('click', () => closeModal(btn.closest('.fixed').id)));
    portfolioModal.addEventListener('click', e => {
        if (e.target === portfolioModal) closeModal(portfolioModal.id);
    });

    // --- REVEAL ON SCROLL & SCROLL REACTIONS ---
    const revealObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                const animatedStat = entry.target.querySelector('.animated-stat');
                if (animatedStat) animateStat(animatedStat);
                revealObserver.unobserve(entry.target);
            }
        });
    }, { threshold: 0.2 });
    document.querySelectorAll('.reveal').forEach(el => revealObserver.observe(el));
    
    window.addEventListener('scroll', () => {
        const scrollY = window.scrollY;
        document.body.style.setProperty('--scroll-y', scrollY);
    });

    // --- ANIMATED STATS ---
    function animateStat(element) {
        const target = +element.dataset.target;
        let count = 0;
        const duration = 1500;
        const stepTime = Math.abs(Math.floor(duration / target));
        const timer = setInterval(() => {
            count++;
            element.innerText = count;
            if (count === target) clearInterval(timer);
        }, stepTime);
    }
    
    // --- DYNAMIC INTERACTIONS (PARALLAX) ---
    const parallaxLayers = document.querySelectorAll('.parallax-layer');
    window.addEventListener('mousemove', e => {
        const x = e.clientX - window.innerWidth / 2;
        const y = e.clientY - window.innerHeight / 2;

        parallaxLayers[0].style.transform = `translate(${x / 20}px, ${y / 20}px)`;
        parallaxLayers[1].style.transform = `translate(${x / 80}px, ${y / 80}px)`;
        parallaxLayers[2].style.transform = `translate(${x / 40}px, ${y / 40}px)`;
    });
    
    document.querySelectorAll('.portfolio-card').forEach(card => {
        card.addEventListener('mousemove', e => {
            const rect = card.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            card.style.setProperty('--mouse-x', `${x}px`);
            card.style.setProperty('--mouse-y', `${y}px`);
        });
        card.addEventListener('mouseenter', () => {
            if(Tone.context.state === 'running') sounds.pop.triggerAttackRelease("C4", "8n");
        });
    });
    document.querySelectorAll('.nav-link, .cta-button, .story-step').forEach(el => {
        el.addEventListener('mouseenter', () => {
             if(Tone.context.state === 'running') sounds.swipe.triggerAttackRelease("C2", "8n");
        });
    });
    document.querySelector('.whatsapp-button').addEventListener('click', function(e) {
        let ripple = document.createElement("span"); this.appendChild(ripple);
        let x = e.clientX - e.target.offsetLeft; let y = e.clientY - e.target.offsetTop;
        ripple.style.left = `${x}px`; ripple.style.top = `${y}px`;
        setTimeout(() => { ripple.remove(); }, 600);
    });

    // --- ANIMATED STORY SECTION ---
    const storySteps = document.querySelectorAll('.story-step');
    const storyContentEl = document.getElementById('story-content');
    function updateStoryContent(step) {
        const data = storyData[step];
        storyContentEl.innerHTML = `<h3 class="text-2xl font-bold text-white mb-2">${data.title}</h3><p class="text-sky-200">${data.content}</p>`;
        storySteps.forEach(s => s.classList.remove('active', 'bg-sky-500/20'));
        document.querySelector(`.story-step[data-step="${step}"]`).classList.add('active', 'bg-sky-500/20');
    }
    storySteps.forEach(step => step.addEventListener('click', () => updateStoryContent(step.dataset.step)));
    updateStoryContent(1);

    // --- GAMIFICATION ---
    const hoveredCards = new Set();
    const badgeToast = document.getElementById('badge-toast');
    let explorerBadgeUnlocked = false;
    
    function showBadge(type) {
        if (type === 'explorer' && !explorerBadgeUnlocked) {
            badgeToast.querySelector('#badge-icon').innerHTML = 'üß≠';
            badgeToast.querySelector('#badge-title').innerText = 'Explorador';
            badgeToast.querySelector('#badge-text').innerText = 'Voc√™ explorou todos os projetos!';
            explorerBadgeUnlocked = true;
            badgeToast.classList.add('show');
            setTimeout(() => badgeToast.classList.remove('show'), 4000);
        }
    }
    
    document.querySelectorAll('.portfolio-card').forEach(card => {
        card.addEventListener('mouseenter', () => {
            hoveredCards.add(card.dataset.id);
            if (hoveredCards.size === portfolioData.length) {
                showBadge('explorer');
            }
        });
    });
    
    // --- MINI JOGO LOGIC ---
    const draggables = document.querySelectorAll('.draggable');
    const timeline = document.getElementById('minigame-timeline');
    const player = document.getElementById('minigame-player');
    const playBtn = document.getElementById('play-timeline-btn');
    const clearBtn = document.getElementById('clear-timeline-btn');
    let timelineItems = [];

    draggables.forEach(draggable => {
        draggable.addEventListener('dragstart', () => {
            draggable.classList.add('dragging');
        });
        draggable.addEventListener('dragend', () => {
            draggable.classList.remove('dragging');
        });
    });

    timeline.addEventListener('dragover', e => {
        e.preventDefault();
        timeline.classList.add('bg-sky-500/10');
    });
    
    timeline.addEventListener('dragleave', () => {
        timeline.classList.remove('bg-sky-500/10');
    });

    timeline.addEventListener('drop', e => {
        e.preventDefault();
        timeline.classList.remove('bg-sky-500/10');
        const dragging = document.querySelector('.dragging');
        if (dragging) {
            const type = dragging.dataset.type;
            const text = dragging.innerText;
            timelineItems.push({ type, text });
            renderTimeline();
            if(Tone.context.state === 'running') sounds.pop.triggerAttackRelease("E4", "8n");
        }
    });
    
    function renderTimeline() {
        if (timelineItems.length === 0) {
            timeline.innerHTML = '<span class="text-sky-400/50">Arraste aqui</span>';
        } else {
            timeline.innerHTML = '';
            timelineItems.forEach((item, index) => {
                const el = document.createElement('div');
                el.className = 'timeline-item bg-sky-500/30 px-3 py-1 rounded-md text-sm';
                el.innerText = item.text;
                timeline.appendChild(el);
            });
        }
    }

    playBtn.addEventListener('click', () => {
        if (timelineItems.length === 0) return;
        let delay = 0;
        player.innerHTML = '';
        timelineItems.forEach((item, index) => {
            setTimeout(() => {
                const animEl = document.createElement('div');
                animEl.className = 'absolute text-white text-2xl font-bold';
                animEl.innerText = item.text;
                let animationClass = '';
                switch(item.type) {
                    case 'text': animationClass = 'animate-bounce'; break;
                    case 'effect': animationClass = 'animate-ping'; break;
                    case 'transition': animationClass = 'animate-pulse'; break;
                    case 'sound': animationClass = 'animate-spin'; break;
                }
                animEl.classList.add(...animationClass.split(' '));
                player.innerHTML = '';
                player.appendChild(animEl);
                if(Tone.context.state === 'running') sounds.glitch.triggerAttackRelease("16n");
            }, delay);
            delay += 1000;
        });
        setTimeout(() => player.innerHTML = '<span>Player</span>', delay);
    });
    
    clearBtn.addEventListener('click', () => {
        timelineItems = [];
        renderTimeline();
    });

});
</script>

</body>
</html>

